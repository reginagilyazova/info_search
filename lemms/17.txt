автоматический переключение маршрут в juniper srx alk0v небольшой инструкция про то как автоматизировать переключение сетевой маршрут в случай проблема с один из линк далёкий просить под кат легенда есть два площадка связанный по l2 транспорт через два разный провайдер нужно обеспечить связность между сеть через isp1 первичный маршрут в случай проблема с isp1 автоматически переключиться на isp2 устройство juniper srx для простой реализация этот задача достаточно на fw1 прописать статический маршрут в сеть 192 168 2 0 через 10 0 0 2 c меньший метрика и через 10 0 0 6 с больший на fw2 наоборот но работать этот метод быть только при падение интерфейс в сторона один из провайдер что на практика бывать очень редко поэтому нужно контролировать состояние канал другой способ для это в juniper есть сервис вот о он использование в это сценарий я и хотеть рассказать на fw1 у мы есть обычный статический запись на fw2 зеркальный через 10 0 0 1 в таблица маршрутизация видеть этот запись настраивать сервис rpm для контроль первичный соединение отправлять пинга на адрес 10 0 0 2 по 10 штука на тест с интервал 5 сечь probe interval 5 интервал между тест тоже 5 сечь том е у мы фактически идти непрерывный пинга каждый 5 сечь если в течение тест мы потерять 5 пинг подряд тест считаться провалить настраивать реакция на тест в случай если тест провалить добавлять маршрут через isp2 проверять на fw2 надо настроить зеркальный конфигурация можно тестировать отключать один из интерфейс vlan из транка в сторона fw чтобы физически линк остаться живой терять около 6 пинг из lan1 в lan2 примерно через 30 сечь видеть на fw1 следующий в таблица маршрутизация видеть новый запись при восстановление соединение через isp1 тест снова переходить в состояние pass и убирать запись из таблица маршрутизация обращать внимание что конфигурация должный быть зеркальный для оба устройство если статический маршрут несколько они можно добавлять новый строка then условие также мочь быть несколько это достаточно гибкий метод весь спасибо надеяться это сэкономить кома то время

