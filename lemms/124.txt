как я взломать пул для майнинга bitcoin moskowsky сегодня веб сайт работать с криптовалюта являться очень вкусный мишень для хакер и вроде бы они безопасность должный быть на высокий уровень но это далеко не всегда так посмотреть хотя бы на где видно как крупный сервис банкротиться и закрываться в результат хакерский атака я это воодушевить и я решить провести собственный исследование безопасность один из такой веб приложение в этот статья я рассказать что из это получиться и сколько я заплатить интересно добро пожаловать под кат итак я посетить viabtc pool один из крупный пул для совместный майнинга выбор быть случайный и базироваться на диаграмма ниже я зарегистрировать аккаунт привязать телефон и подключить двухфакторный аутентификация через google authenticator также быть включить опция authenticate when sign in viabtc 2fa при вход вот так выглядеть аккаунт потенциальный жертва поехать в дать случай если пользователь веб приложение посетить вредоносный сайт то он email измениться на адрес атаковать работать это так великолепно почта успешно привязаться и атаковать автоматически залоггиниться в аккаунт жертва но влажный фантазия наш воображать хакер о несметный криптобогатство прерв том тот самый редирект тот хоум да это окно втрого шаг аутентификация 2fa при вход помнить далее быть обнаружить критический уязвимость в реализация двухфакторный аутентификация некоторый функция веб приложение требовать подтверждение второе фактор аутентификация только в фронтенд если отправить запрос непосредственно на бэкенд то он быть успешно выполнить без надлежащий аутентификация такой образ атаковать способный отключить двухфакторный аутентификация при вход несмотря на то что он не прош литр тот самый двухфакторный аутентификация что несомненно являться смотреть сам что ещ можно быть сделать отправлять запрос непосредственно на сервер давать вспомнить один уязвимость где браузер жертва сам отправить запрос на смена email a если пользователь необходимый изменить email то фронтед запросить подтверждение через два фактор аутентификация но если отправлять запрос напрямую то подтверждение не требоваться из за такой недостаток безопасность атаковать и смочь изменить email использовать csrf на дать этап атаковать получить доступ в аккаунт и к он конфиденциальный информация но такой важный операция как например смена пароль вс ещ защитить двухфакторный аутентификация веб приложение разрешать использовать два метод подтверждение операция sms код или код из google authenticator но я обнаружить ещ один метод email код я обратить внимание на процесс подтверждение операция через sms он состоять из запрос на отправка код и запрос на подтверждение использовать получить код выглядеть это так в это запрос быть бы неплохо изменить sms на email подумать я а здесь логично sms_code на email_code да у атаковать нет доступ к smsка жертва и да у он нет доступ к аккаунт google authenticator жертва но у он есть доступ к email у он быть привязать к аккаунт благодаря csrf итак финальный шаг вот такой нехитрый образ злоумышленник завладеть аккаунт обычный пользователь веб приложение цепочка уязвимость позволять полностью украсть аккаунт что конечно же критично тем не менее уязвимость исправить не сложно но если смотреть глубокий этот уязвимость просто симптом по который можно диагностировать главный это не просто исправить тот несколько уязвимость что я обнаружить важный смотреть в корень проблема технический команда должный сделать вывод и постоянно улучшать они знание в область безопасность да возможно этот мысль банальный и очевидный но мы каждый месяц наблюдать громкий заголовок о взлом очередной криптобиржа забавно то что это вроде бы как новое технология с огромный риска миллион деньга который мочь безвозвратно покинуть ваш коидти к но вс тот же разработчик который не знать что такой csrf я вс upd заплатить 1 btc по курс на тот момент около 18 000

