как поднять проект на php в docker под windows lavkasnov статья являться набор простой понятный инструкция и совет для пользователь docker под windows статья помочь разработчик на php быстро поднять проект описываться проблема и они решение статья полезный тем кто не обладать бесконечный ресурс время чтобы глубоко копаться в проблема докер под windows автор быть бы бесконечно признательный если бы он ранее встретиться подобный статья и автор бы съэкономить бы много сила и время текст мочь содержимый ошибка и неточность статья не являться полный и исчерпывающий руководство по docker for windows в статья не описываться ничто новое и не разглашаться ранее неизвестный факт весь это вы мочь самостоятельно найти в разный источник статья также не отвечать на вопрос перейти ли цыплёнок дорога это важный шаг если вы он пропустить или не выполнить то возможно нижеследующий инструкция вообще не иметь смысл для вы выполнить windows r lusrmgr msc открыться локальный пользователь и группа далее пользователь контекстный меню в немой новый пользователь добавить новое пользователь например dockerhost с обязательный пароль пароль являться обязательный добавить членство в группа администратор другой группа не добавлять далее в docker settings shared drivers отметить нужный вы диск и ввести дать логин и пароль новое пользователь сохранить настройка если вы ранее вводить логин и пароль пользователь под который работать то ввести дать новое пользователь хотеть огрести проблема в неожиданный место использовать рабочий аккаунт и далёкий статья не читать на простор интернет встречаться всякий конфига docker compose yml для php вэбсервер какой то они часть не запуститься под windows я рекомендовать посмотреть у я конфига из генератор завестись сразу и поэтому далее я редактировать конфига именно оттуда окончательный результат выложить в вариант из генератор плохой несколько вещь описание проблема и она решение приводиться ниже проблема невозможно хранить файл бд на локальный диск это следовать принять как аксиома под windows и попытаться найти приемлемый решение чтобы дать храниться вне контейнер для windows это named volume всего пара строка решать этот проблема named volume находиться в папка var lib docker volumes виртуальный машина докер mobilinuxvm прямой доступ к это файл нет только через контейнер посредник я неизвестно решение как сделать доступный этот папка из под windows для управление named том воспользоваться комманда docker volume например удалить не использовать том docker volume prune вы не нужно париться с право и пользователь для файл в named volume за вы весь делать докер за что он большой спасибо в некоторый руководство по настройка постоянный хранилище бд в докер приводиться танец с назначение право под windows без named volume у вы ничто не выйти ну один раз мочь и запуститься а вот при повторный запуск загнуться вы даже не представлять какой быть облегчение когда заработать постоянный хранилище с named volume ssh ключ также добавить через named volume причина для приватный ключ нужный особый право а этот возножность не давать обычный том под windows процитировать требовать кусок из docker compose yml чтобы это заработать необходимый в named volume скопировать ключ изменить право на приватный ключ протестировать связь весь этот действие можно оформить в вид один bat файл в скрипт естественно вместо first_ssh подставить свой имя том напомнить что название named volume быть сформировать докер как compose_project ssh в наш случай вместо ssh поставить путь к ваш ключ ну или временно скопировать папка с ключ туда где запускать этот скрипт если вы добавлять свой ключ на github то в самый конец github поприветствовать скрипт являться одноразовый и он следовать запустить сразу после успешный первое старт ваш контейнер docker compose up d повторный запуск не иметь никакой смысл разве что если вы удалить named volume чтобы соедениться между контейнер описать в один docker compose yml файл ничто ненужный достаточно указать имя сервис или имя контейнер как имя хост номер порт менять не нужно работать порт по умолчание на это можно быть бы закончить если бы не требоваться получать и отправлять запрос в контенйер из другой docker compose yml с это тоже никакой проблема достаточно указать название сеть и контейнер в сеть процитировать нужный участок docker compose yml обратить внимание что имя сеть second_default не поместить в переменный окружение потому что глобальный секция networks не позволять использовать переменный в принцип тогда теряться смысл использовать переменный в секция php где это возможно например поместить туда имя контейнер из внешний сеть если в env файл задать external_nginx second_nginx то в код на php достаточно быть использовать имя хост second_nginx чтобы сделать http запрос порт по прежний 80 и специально он прописывать не надо в репозиторий я добавить скрипт проверка связь между контейнер из разный docker compose yml достаточно выполнить docker compose exec php php get php чтобы удостовериться в работоспособность при первое запуск контейнер докер мочь ругнуться error network second_network declared as external but could not be found please create the network manually using and try again собственно весь верно воспользоваться подсказка докер и вручную создать сеть хотеться бы иметь лог от весь сервис в один папка доступный локально делаться это несложно при помощь обычный том главный включить логирование в самый сервис для php это опция в файл php ini в nginx в он конфига в postgres тоже с php и nginx весь просто иметься соответствующий файл в наш конфига для postgres прийтись воспользоваться опция коммандный строка существовать ещё путь через файл postgresql conf но это быть несколько сложный полный текст docker compose yml в репа и в конец статья надо сказать что я до сей пора не довольный настройка логово пока устраивать как есть желающий более тонкий настройка логирование мочь воспользоваться документация соответствующий сервис отличный вариант сделать docker compose yml почти универсальный конфиго являться файл env полный универсальность не получиться из за глобальный секция networks где невозможно указать переменный среда из особенность мой файл это переменный для postgress который не нужно прописывать в самый docker compose yml в php для коннект к бд можно воспользоваться если обратить внимание то я для php и nginx использовать свой собственный образ я это экономить время при тестирование вы ничто не мешать использовать другой образ контейнер мой конфига всего лишь дть свой образ легко построить в посмотит в репа папка build где создаваться использовать образ привести здесь финальный вариант docker compose yml если кома то лень лезть в репа как видеть ничто сложный и весь работать также привести несколько полезный комманда который я оформить в вид bat файл запуск тест codeception и сам test sh после этот статья возникнуть вопрос в состояние решить официальный документация по докер или другой использовать компонент на это весь удача в разработке

