знакомство с concourseci w32blaster весь привет я заметить что на хабра очень мало информация про такой сервер сборка как concourseci я решить восполнить этот пробел и написать небольшой введение под кат описание это инструмент и небольшой туториал итак concourseci это сервер сборка ci cd разрабатываться он компания pivotal в данный момент находиться в стадия активный разработка в самый комания есть несколько человек который работать на полный ставка целиком на это проект так что новое версия на данный момент выпускаться довольно регулярно дополнительный фич внедряться активно и баг исправляться быстро изначально как это чаща всего бывать pivotal сделать этот инструмент для внутренний использование потому что быть неудовлетворённый дженкинс но в последствие опубликовать этот проект на гитхаб и сообщество подтянуться в релиз часто встречаться новый функционал от сторонний разработчик из сообщество написать целиком на язык go в этот статья достоинство установка три концепция внешний вид вэб интерфейс fly конфигурация конвейер секрет зачем нужный таска достоинство перечислить основной достоинство это продукт каждый операция запускаться в отдельный docker контейнер что делать этот продукт абсолютно независимый от технология то есть собирать можно люба код который собираться внутри какой либо докер контейнер процесс сборка описываться в форма том наш pipeline конвейер потому что современный сборка вс реж становиться линейный и описать сложный процедура сборка в вид такой график становиться очень удобно и наглядно concourseci поставляться с удобный графический веб интерфейс который использоваться только для чтение хотя на данный момент запустить новый дизайн в бета режим он активно обсуждаться сообщество так что мой скриншот вероятно устареть в ближний будущее новый интерфейс возможно быть выглядеть примерно вот так из коробка легко расширяться горизонтально если у вы не хватать ресурс вы мочь запустить ещ один воркер на новый машина указать в качество параметр адрес главный сервер и вс остальной сделаться за вы воркер сам себя зарегистрировать сообщить о себя и уже сразу же быть готовый выполнять какой то работа более тот если у вы есть в процесс сборка какой то параллельный операция то они вполне мочь бежать на разный физический машина операция добавление новое воркер это буквально запуск один команда установка как я упоминать проект написать на go поэтому релиз поставляться единый бинарный файл и он можно запустить один команда но есть способ хороший concourseci предоставлять официальный докер образ так что можно запустить проект всего один команда использовать уже docker compose запустить concourseci состоять из тр х часть postgresql база дать concourse web это что то вроде мастер тут работать графический вэб интерфейс и самый главный atc термин atc или air traffic control позаимствовать из авиация это вышка управление половина тами который стоить в аэропорт у взл тно посадочный полоса где диспетчер руководить половина тами самол тов atc распределять ресурс запускать разный задача следить за кластер важный помнить что реальный сборка не происходить в concourse web он только лишь руководить сборка делегировать задача доступный воркер в система мочь быть только один главный concourse web concourse worker вот тут то и происходить реальный работа воркер получать задание от atc и выполнять он отчитаться о свой результат такой воркер мочь быть в система столько на сколько у вы хватить железо рекомендоваться запускать один воркер на один сервер инстанс такой образ полностью рабочий сервер можно запустить всего один docker compose команда но перед самый один запуск вы следовать сгенерировать ключ потому что atc общаться с воркер по зашифровать канал и необходимый оба сторона подсунуть ключ перед запуск генерировать ключ вот так ну и после это мы смочь запустить весь система вот с такой файл не забыть экспортировать в переменный concourse_external_url реальный значение вэб адрес на который быть доступный вэб интерфейс как видеть в это пример мы запускать вс на один машина но никто вы это не ограничивать и можно сметь создавать распредел нный кластер согласно свой потребность после запуск мочь открыть в браузер адрес ваш сервер в пример выше http 192 168 99 100 8080 и вы увидеть пока ещ пустой concourse web дробный про установка тут три концепция итак прежде чем перейти к дело давать разбер мся с терминология чтобы понимать друг друг concourseci оперировать три основный понятие resource ресурс который мочь предоставлять материал для сборка или мочь быть обновть наш результат сборка типичный пример git hg репозиторий докер регистереть ftp s3 чат емайла телеграм бот и прочий полный список тут плюс можно всегда что то найти на простор гитхаб и на крайний случай можно написать самый важный понимать что ресурс не делать никакой конкретный работа он всего лишь предоставлять материал для дальнейший действие task это единица работа который мочь быть сделать в рамка ваш сборка таск запускаться в выбрать вы докер контейнер job задание объединять ресурс и таска в один целое иной слово внутри задание мы бер метр ресурс как то обрабатывать в таска собирать и обновлять ресурс результат один задача полностью изолировать и мочь быть запустить отдельно сколько угодный раз внешний вид вэб интерфейс и в браузер concourseci выглядеть примерно так это очень простой пример для конвейер но тут видно как мы бер метр исходник из гит репозиторий и запускать сборка проект созд метр докер образ и оповещать весь в телеграм канал с помощь соотвествуть ресурс на дать скриншот видный только ресурс и задача но не видный таска но если нажать на один из задача в это пример у мы она один то можно увидеть что твориться внутри зел ный квардрат на дать снимка цифра отметить кнопка ручной запуск задача вы е мочь запустить ещ раз в люба момент время весь предыдущий билд выстраиваться в длинный цепочка под заголовок в вид история ресурс который бер том исходник стрелочка вниз означать get то есть мы забирать из ресурс материал вывод работа один таска можно раскрыть этот ссылка и увидеть лог stdout из наш контейнер что происходить в время сборка наш проект мы собирать ресурс докер образ и забрасывать он в приватный регистереть стрелочка наверх означать put то есть мы обновлять ресурс наконец кидать сообщение в приватный телеграм канал в это интерфейс можно просматривать весь конвейер и таска следить за результами в качество пример совсем продвинуть версия конвейер можно привести конвейер самый concourseci да как ни удивительно но сам он собираться имя же сам но как я уже упоминать выше вэб тут только для чтение возникать резонный вопрос а как же тогда добавлять новое конвейер в проект настать время представить вы fly fly fly это утилит командный строка который позволять управлять весь ваш кластер concourseci из терминал ставиться на ваш рабочий компьютер и упралвять сервер с она вы мочь совершать весь необходимый операция и обслуживать кластер вывод справка по дать команда малый часть команда из себя представлять так же один бинарник написать на go он можно скачать с гитхаб но удобный быть скачать воспользоваться ссылка внизу вэб интерфейс и закинуть в usr bin fly сделать он запускать итак вы установить fly для начало работа c concourseci необходимый пройти аутентификация в ваш сервер делаться это весьма просто

