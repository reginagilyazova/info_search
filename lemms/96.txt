мобильный устройство изнутри что такой gpt vin2809 продолжать рассматривать строение программный часть мобильный устройство сегодня поговорить о устройство раздел память написать о это я побудить публикация вместо тот чтобы писать комментарий к она я хотеть бы не поругать или поправить автор а дополнить вышеуказанный публикация с уклон в итак gpt guid partition table это существовать два схема разметка память и каждый схема содержаться в отдельный раздел память называть соответственно или как устроить схема разметка можно посмотреть в а это другой формат описание разметка память guid guid partition table он являться частью efi extensible firmware interface стандарт использовать вместо bios для загрузка раздел память переход на другой формат позволить устранить самый существенный недостаток mbr формат малое число раздел если в помещаться только 4 запись с ограничение на длина раздел и он смещение из за тот что этот параметр описываться 32 разрядный число то в можно разместить 128 запись о раздел причём они параметр уже описываться в 64 разрядный система счисление для совместимость с старое стандарт загрузка bios и с цель защита самый таблица описание раздел память раздел тоже начинаться с который описывать всего один раздел весь память му сам называться теперь защитный protective том е pmbr она располагаться тоже в первое сектор память по адрес 512 байт пол указывать на начать заголовок а размер раздел устанавливаться равный длина весь память устройство тип раздел иметь значение gpt раздел быть защита раздел да и весь память сводиться к следующий если такой раздел открыть средство работа с схема разметка то оно увидеть пустовать неразмеченный память состоять только из раздел описание разметка соответственно что либо сделать с этот память он не удаститься вот как выглядеть например от му защитный mbr том е pmbr по адрес видный сигнатура 0xaa55 перейти к рассмотрение непосредственно структура раздел раздел состоять из заголовок и таблица описание раздел память сразу за том е с адрес располагаться иметь длина 0х5с 92 байт но занимать весь сектор 512 байт вот как он выглядеть в тот же заголовок gpt он иметь следующий структура пол содержимый строка символ efi part 45h 46h 49h 20h 50h 41h 52h 54h который выделить на рис 2 бирюзовый цвет и однозначно идентифицировать gpt раздел пол выделить зелёный цвет содержимый номер версия структура gpt раздел 0х00010000 например для gpt версия 1 0 должный быть 00h 00h 01h 00h пол выделить оранжевый цвет содержимый размер заголовок выразить в байт пока это 0х0000005ch что означать 92 байт пол выделить розовый цвет содержимый контрольный сумма заголовок 0x09be8e1f расчитать по алгоритм crc32 при непосредственный выполнение расчёт учитываться только 92 байт а в это пол перед расчёт заноситься 0 следующий пол никак не выделить являться резервный и содержимый 0 пол выделить темно синить цвет содержимый смещение в блок размещение первичный gpt раздел 0х00000001 пол содержимый смещение в блок размещение резервный gpt раздел оно не указать пол выделить красный цвет содержимый смещение в блок размещение первое разрешить для использование сектор память 0х00000022 расчитываться так lba последний сектор занятой первичный gpt раздел 1 пол содержимый смещение размещение последний сектор память разрешить для использование расчитываться так lba первое сектор резервный gpt раздел 1 оно не указать пол выделить голубой цвет содержимый guid прошивка пол выделить красный цвет содержимый смещение начало gpt в первичный всегда равный 2 а в резервный равный lastusablelba пол выделить ярко зелёный цвет содержимый размер таблица описание раздел том е число запись о раздел 0х00000018 пол выделить розовый цвет содержимый размер один запись о раздел в байт согласно размер запись фиксировать и составлять 128 байт или 0х00000080 пол выделить красный цвет содержимый контрольный сумма таблица описание раздел 0x93d54d33 расчитать по алгоритм crc32 при выполнение расчёт учитываться весь байт начинать с partitionslba и до firstusablelba пол содержимый резервный пол содержимый 0 до конец сектор том е 420 байт для сектор размер 512 байт непосредственно сразу за заголовок начинать с адрес располагаться таблица описание раздел содержимый запись о каждый раздел память включая и сам раздел разметка вот как она выглядеть таблица описание раздел каждый запись размер 128 байт иметь следующий структура пол выделить красный цвет содержимый guid тип раздел который определять файловый система использовать для хранение дать в это раздел каждый файловый система получать свой guid однозначно е идентифицировать стандарт uefi жёстко определять только следующий guid тип раздел поставщик ос vendors нужно генерировать свой собственный guid тип раздел чтобы идентифицировать они некоторый известный guid можно посмотреть в при запись в память или в файл образ значение guid записываться в друг порядок например guid системный раздел efi иметь следующий вид c12a7328 f81f 11d2 ba4b 00a0c93ec93b порядок запись байт в написание guid являться little endian причём задом наперёд писаться байт только в один три блок для привести выше guid запись в таблица раздел быть иметь такой вид пол выделить синить цвет содержимый guid раздел являться уникальный идентификатор раздел поэтому создаваться каждый раз когда создаваться раздел пол выделить зелёный цвет содержимый смещение в блок на один сектор раздел 0x00020000 пол выделить оранжевый цвет содержимый смещение на последний сектор раздел 0x0003ffff при это размер раздел partitionsize определяться по формула пол выделить фиолетовымый цвет содержимый атрибут флаг раздел 8 байт 64 битый флаг распределить следующий образ битый с 0 по 47 48 шт отвести под общий атрибут тип раздел а остальной 16 битов с 48 по 63 описывать конкретный раздел вот небольшой описание этот битов пол выделить синить цвет содержимый метка раздел modem содержимый строка текст с завершать нуль число не более 36 символ выразить в кодировка utf 16le весь что такой gpt мы уже знать только это стандартный структура раздел оказываться иметься и модификация том к я обнаружить раздел другой структура при работа с на основа чип то я и назвать она прошивка новый мобильный устройство му lenovo выполнить на основа чип иметь схема разметка память но структура самый файл отличаться от стандартный описать в 1 это касаться например устройство yoga book yb1 x90 по сравнение с стандартный структура тип сократить до максимум том к структура файл это тип отличаться от стандартный структура то для он прошивка необходимый использовать специальный флешер фирма phoneflashtool_5 3 2 0 раздел как и стандартный состоять из строение gpt файл intel тип рассмотреть строение заголовок заголовок иметь размер всего 12 байт против 512 в стандартный вариант заголовок gpt файл intel тип и содержимый следующий поль пол отметить синить цвет содержимый число идентифицировать образ пол отметить красный цвет содержимый значение смещение размещение первое раздел память пол отметить зелёный цвет содержимый общий число раздел память том е число запись таблица описание раздел сам таблица расположить сразу после заголовок таблица описание раздел содержимый запись содержимый параметр каждый раздел память число запись равно число раздел а окончание таблица ничто не отмечаться каждый запись иметь размер 108 байт тогда как по она содержимый 128 байт вот как выглядеть запись описание раздел новое формат запись описание раздел и содержимый следующий поль описывать параметр раздел пол выделить на рис 6 синить цвет содержимый размер раздел выразить в мб 1024 1024 1048576 байт пол выделить на рис 6 красный цвет содержимый метка раздел том е имя раздел выразить в кодировка utf 16 пол выделить на рис 6 зелёный цвет содержимый guid тип раздел пол выделить на рис 6 жёлтый цвет содержимый guid самый раздел изучить строение раздел разметка память можно приступить и к практический занятие в следующий публикация я поделиться опыт переразметка память выполнить по схеме

