xception компактный глубокий нейронный сеть roryorangepants в последний несколько год нейронный сеть пробраться в весь отрасль машинный обучение но самый большой фурор они бесспорный произвести в область компьютерный зрение в рамка соревнование быть представить множество различный архитектура св рточный сеть который затем разойтись по фреймворка и библиотека чтобы улучшить качество распознавание свой сеть исследователь стараться добавлять в сеть большой сло в однако с время пришлый понимание что иногда ограничение производительность попросту не позволять обучать и использовать настолько глубокий сеть это стать мотивация для использование depthwise separable convolutions и создание архитектура xception если вы хотеть узнать что это такой и посмотреть как использовать такой сеть на практика чтобы научиться отличать котов от собака добро пожаловать под кат каждый раз когда мы добавлять очередной слой в св рточный сеть мы нужно принимать стратегический решение про он характеристика какой размер ядро св рткать мы использовать 3х3 5х5 а мочь быть поставить max pooling в 2015 год быть предложить архитектура inception идея который заключаться в следующий давать вместо тот чтобы выбирать размер ядро возьма метр несколько вариант сразу использовать они весь одновременно и конкатенировать результат однако это существенно увеличивать количество операция который необходимый выполнить для вычисление активация один слой поэтому автор предлагать такой хитрость давать перед каждый св рточный блок делать св рткать с размер ядро 1х1 снижать размерность сигнал подаваться на вход св ртка с б льший размер ядро получиться на рисунок снизу конструкция и составлять полный модуль inception но какой отношение это иметь к тот чтобы сделать наш сеть более компактный в 2016 год франсуа шолл francois chollet автор и разработчик фреймворка keras опубликовать в который предложить пойти далёкий и использовать так называть экстремальный inception модуль также известный как depthwise separable convolution представимый что мы взять стандартный св рточный слой с фильтр размер 3х3 на вход который подаваться тензор размерность где это ширина и высота тензор а количество канал что делать такой слой он сворачивать одновременно весь канал исходный сигнал разный св ртками на выход у такой слой получаться тензор размерность давать вместо это сделать последовательно два шаг давать разбер метр конкретный пример пусть мы сворачивать изображение с 16 канал св рточный слой с 32 фильтр суммарно этот св рточный слой быть иметь весы так как у мы быть св рток 3х3 сколько же весы быть в аналогичный depthwise separable convolution блок в один у мы быть весы у pointwise convolution в второе у мы быть весы у depthwise convolution в сумма получить 800 весы что намного маленький чем у обычный св рточный слой обычный св рточный слой одновременно обрабатывать как пространственный информация корреляция соседний точка внутри один канал так и межканальный информация так как св ртка применяться к весь канал сразу архитектура xception базироваться на предположение о тот что этот два вид информация можно обрабатывать последовательно без потеря качество работа сеть и раскладывать обычный св рткать на pointwise convolution который обрабатывать только межканальный корреляция и spatial convolution который обрабатывать только пространственный корреляция в рамка отдельный канал посмотреть на реальный эффект для сравнение возьма метр два по настоящий глубокий архитектура св рточный сеть resnet50 и inceptionresnetv2 resnet50 иметь 25 636 712 весы а предобученный модель в keras весить 99 мб точность который достигаться этот модель на датасет imagenet составлять 75 9 inceptionresnetv2 иметь 55 873 736 обучать параметр и весить 215 мб достигать точность 80 4 что же получаться с архитектура xception сеть иметь 22 910 480 весы и весить 88 мб при это точность классификация на imagenet составлять 79 такой образ мы получать архитектура сеть который превосходить по точность resnet50 и лишь чуть чуть уступать inceptionresnetv2 при это а значит по требовать ресурс как для обучение так и для использование этот модель разбер метр на короткий пример как применить этот архитектура к реальный задача для этот цель возьма метр датасет с kaggle и за полчаса научить наш сеть отличать котик от собачка разбить датасет на три часть train 4000 изображение validation 2000 изображение и test 10000 изображение так как франсуа шолл автор архитектура xception по совместительство являться создатель keras он любезно предоставить вес этот сеть обученный на imagenet в сво метр фреймворка чем мы и воспользоваться чтобы дотюнить сеть под наш задача с помощь transfer learning загрузить вес с imagenet в xception из который убрать последний полносвязной слоить прогнать наш датасет через этот сеть чтобы получить признак который св рточный сеть мочь извлечь из изображение так называть bottleneck features создать полносвязной сеть и обучить е на признак получить из св рточный сло в использовать для валидация специально отложить часть исходный набор дать уже после этот стадия который занимать пара минута на видеокарта geforce gtx 1060 мы получать accuracy около 99 4 на валидационный датасет теперь попробовать дообучить сеть с аугментация входной дать загрузить в св рточный слоить вес с imagenet а в полносвязной слоить вес который наш сеть выучить только что обучить сеть в такой режим ещ за пять эпоха около двадцать минута мы достигнуть точность в 99 5 на валидационный датасет проверить модель на дать который она никогда не видеть и который не использоваться для настройка гиперпараметр тестовый датасет увидеть точность около 96 9 что выглядеть довольно приемлемый полный код для это эксперимент можно найти на в 2017 год google добавить в tensorflow предобученный сеть архитектура использовать принцип похожий на xception для тот чтобы сделать модель ещ маленький этот модель пригодный для выполнение задача компьютерный зрение прямо на мобильный телефон или iot устройство обладать крайне ограниченный запас память и слабый процессор такой образ мы незаметно подойти к тот точка в история computer science когда написать приложение определять изобразить ли на фото птица можно за пятнадцать минута прич метр это приложение быть выполняться прямо на ваш смартфоне

