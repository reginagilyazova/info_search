скрипт добавление пакет обновление в образ windows ostan этот статья являться логический продолжение мой статья развивать тема добавление установка интеграция пакет обновление в образ windows я решить написать скрипт оперировать команда который автоматизировать процесс и избавлять системный администратор от рутинный действие скрипт состоять в тот что с он помощь можно установить пакет обновление на живой система либо интегрировать в образ windows файл скрипт состоять в тот что он работа можно настроить изменить значение несколько переменный в начало всего код как и в предыдущий статья для пример мы быть добавлять к образ windows так называть kb3125574 а также необходимый kb3177467 в ход работа над скрипт выясниться что после интеграция в образ kb3177467 он образ становиться непригодный для дальнейший интеграция если устанавливать kb3177467 на живой ос то проблема не возникать у дать проблема есть два решение 1 интегрировать kb3177467 последний 2 заменить проблемный обновление он предыдущий версия kb3020369 я выбрать два вариант реализовать в скрипт ветвление по условие как уже отмечаться скрипт мочь установить обновление или интегрировать они если в папка запуск отсутствовать файл образ то скрипт выполнять установка обновление в полностью автоматический режим если в папка запуск присутствовать файл образ то скрипт выполнять считывание из он информация о иметься индекс и предлагать ввести номер после это отображаться расширить информация о выбрать индекс выд тся запрос на монтирование нажатие люба клавиш приводить к возврат а нажатие клавиш m запускать следующий цепочка действие монтирование образ интеграция обновление размонтирование образ возврат в меню выбор индеска после что можно выбрать другой индекс для интеграция обновление выбор индекс под номер 0 запускать установка обновление на живой ос вначале команда происходить установка переменный можно изменить предполагать имя файл образ например на можно изменить имя папка монтирование или задать путь если папка монтирование должный находиться за предел папка запуск можно изменить уровень логирование для исключение информационный сообщение из файл лог система предварительный меню получение основной информация о файл с контроль ошибка если ошибка 2 отсутствовать файл то запуск в режим online не найти информация о максимальный количество индекс в один образ и установить значение 24 индексный меню получение расширить информация о выбрать индекс в файл с контроль ошибка предложение смонтировать индекс определение разрядность ос для интерактивный обслуживание считываться системный переменный среда а для автономный обслуживание из образ запрашиваться необходимый информация и в она искаться ключевой строка добавление пакет чтобы не делать лишний работа вначале происходить запрос список уже добавить установленный или интегрировать пакет а потом перед каждый команда запуск осуществляться вызов псевдофункция для проверка псевдофункция проверка работа описать в статья код слегка подправить монтирование образ предварительно созд тся папка монтирование контроль ошибка изменяться переменный определять спецификация образ теперь указывать на путь к автономный образ размонтирование образ если выполняться интерактивный обслуживание online то размонтировать не нужно возвращение переменный к исходный значение работа данный скрипт тестироваться на ос windows 7 с встроить утилита версия 6 1 7600 16385 в версия ос windows 8 8 1 10 утилит система иметь более высокий версия думать обратный совместимость сохранить и скрипт быть также работоспособный к тот же появиться возможность работать с файлами

