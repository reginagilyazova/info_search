Верстка сборника тезисов конференции в LaTeX
StarHunter
В конце прошлого года в Ракетно-Космической Корпорации "Энергия" прошла конференция молодых ученых и специалистов. Автор этой статьи входил в состав секретариата, в частности выполнял функцию верстки сборника тезисов. Описание возникших проблем и путей их решения под катом.
К сожалению, система верстки LaTeX не распространена (по моей статистике) среди инженеров. Вместо использования команд форматирования высококлассные специалисты применяют, как метко выразился один профессор МГТУ им. Баумана, навязанный юристами и бухгалтерами редактор (конечно, речь об MS Word). Да, несомненно, при верстке некоторых объектов встречаются технические сложности, заставляющие потратить несколько часов на поиски элегантного решения, но эти затраты нивелируются, если в написании документа участвует группа людей, или если необходимо строго придерживаться определенного шаблона оформления. Про набор, верстку и внешний вид формул молчу.
Еще на этапе подготовки к конференции возникла мысль дать возможность авторам присылать тезисы, сверстанные в LaTeX (как вы уже поняли, ваш покорный слуга является ее ярым поклонником), для чего был разработан стилевой класс и шаблон документа.
Изначально я не предполагал верстать все тезисы при помощи LaTeX'а: планировалось, что секретари конференции пришлют уже подготовленные части сборника тезисов, каждый по своей тематической секции, а я должен быть их подчистить в плане форматирования, объединить в отдельный документ и преобразовать в PDF. Однако, мои глаза не смогли спокойно смотреть на присланный материал, к тому же в тот момент по основной работе было не слишком много текучки, что позволило потратить время на верстку тезисов в LaTeX'е.
Итак, мой рабочий цикл выглядел следующим образом:
1) Копирую текст из Word'а в VIm;

2) При помощи регулярного выражения добавляю переносы строк после каждой точки (мне так нравится), добавляю дополнительные переносы строк в окончания абзацев;

3) При помощи регулярного выражения оформляю заголовок доклада и информацию об авторах;

4) Оформляю список литературы в виде списка LaTeX;

5) Преобразую в PNG и вставляю картинки, набираю формулы.
Всего в сборнике тезисов было почти четыре сотни работ. Необходимо отметить, что десяток работ из них были сверстаны в LaTeX'е.
В процессе верстки подключил к VIm'у плагин latexsuite — он позволил мне сэкономить немного времени.
Что получилось автоматизировать (в основном, регулярными выражениями):
Что не получилось (не хватило терпения/желания) автоматизировать:
Что невероятно поразило — некоторые авторы кладут в DOC-файл рисунок большого размера (например, скриншот разрешением 1920x1280), а затем средствами текстового редактора кадрируют его, вырезая чертеж или окно (например, размером 400x300 пикселей). Переоформление такого рода рисунков заняло довольно много времени и потребовало определенной аккуратности.
Кроме таких рисунков, много времени съело преобразование рисунков, нарисованных средствами Word, в растровую картинку. Приходилось рендерить DOC-файл в PDF-формат при помощи CutePDF, а затем вырезать изображение из нужной странички PDF-документа. Правда, в отдельных случаях удалось оперативно получить от авторов рисунки в виде отдельных файлов.
И, конечно, отдельное удовольствие доставил повторный набор формул, изначально представленных в DOC-файле, в командах LaTeX'а.
Оформление сборника тезисов, имеющего суммарный объем побольше 700 страниц, содержащего тезисы почти 400 работ, заняло порядка 60 рабочих часов. На мой взгляд, выполнение аналогичных задач в MS Word, а именно: переформатирование в единый стиль, единообразная запись информации об авторах, приведение к единообразию кавычек и тире, вставка неразрывных пробелов вместо обычных, потребовало бы не меньшего времени. По крайней мере у меня.
Полученный документ радует красивыми шрифтами и единообразным оформлением.
И напоследок космическая картинка...
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

