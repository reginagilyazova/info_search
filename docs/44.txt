Как не стать честным рассыльщиком
BubnovRV
Давно хостился на одном ресурсе, у которого была услуга «списки рассылки». Для тех, кто не в курсе – загружаешь список адресов (списки сформированы легально, никакого спама, Double Opt-in) и формируешь письмо, сервис автоматически рассылает письмо по всем адресатам. Собственно всё устраивало, кроме одного – статистики. Хотелось знать, сколько доставлено, сколько прочитано и т.д. и т.п.  
 
Начал разбираться. У «большой тройки» (Mail.ru, Yandex и Google) существуют специальные сервисы для анализа такой статистики. И опять затык, если Yandex и Google такие рассылки идентифицируют по SPF (для Google еще надо добавить хедеры в письмо, для Yandex вообще ничего не надо), то Mail.ru отличился (и не раз, собственно про него и пост) – только DKIM! 
 
Чтобы всё работало нужно SPF, DKIM и DMARC (для полноты картины). SPF и DMARC реализуются легко через записи DNS, то DKIM далеко не у всех. Если хостер, не жлоб, и не просит за это дополнительную плату, как некоторые известные хостеры. 
 
Перебрал и нашел хостера, который поддерживает SPF, DKIM и DMARC и не просит за это дополнительных денег (кстати, дешевле, чем у моего текущего хостера, который таких услуг не предоставлял). 
 
Итак, поехали. Поскольку «списков рассылки» у него не было, пришлось «пилить» собственную прогу. 
 
Первый прокол. Если Yandex и Google не накладывает ограничений на входящий поток с одного сервера, то Mail.ru наоборот сразу банит, возвращая ошибку кода 5хх. Существует некое магическое число, после которого вас начинают «рубить», добиться конкретных значений от техподдержки Mail.ru не удалось. Google вообще не ответил на запрос, а Yandex ответил, что таких ограничений вовсе нет. 
 
Поскольку создать группировку серверов в рамках стандартного тарифа мне неподвластно – ввел задержку между отправками на домены Mail.ru (bk, list и т.д.). Дело пошло. 
 
Тут второй прокол. В Mail.ru существует такой параметр как «Репутация» 
 
 
 
Чем он меньше, тем лучше. Как написано в мануале чем он меньше, тем меньше вероятность, что твое письмо попадёт в спам или вообще будет отвергнуто. Так вот это неправда – сам Mail.ru игнорирует этот параметр. Смотрите при больших параметрах репутации все письма попадают во входящие (январь, февраль), а при меньших наоборот часть попадают в спам (март). 
 
Третий прокол – параметр «Тенденция». Данный параметр должен показывать тенденцию изменения параметра «Репутация», но показывает ветер в квартире. 
 
 
 
Не пытайтесь понять его логику. Данный параметр растёт и падает в зависимости от удаленности тысячи комет от Земли. Показывает рост 150%, но на следующий день параметр на прежнем месте и наоборот. Для понимания «всплески» количества писем это дни когда действительно была рассылка, остальные дни это обычная рабочая переписка (да действительно так мало писем, но только на сервера Mail.ru). 
 
Чётвертый прокол. Периодически в графе «Жалобы» стали появляться цифры отличные от нуля. Как же так, ведь все получатели подписывались самостоятельно, почему же попадание в «СПАМ»? Тут плюс в карму Mail.ru – FBL, который позволяет получить адрес пользователя, который нажал кнопку «СПАМ» в интерфейсе почты. Я стал писать (с другого адреса) таким пользователям «почему же Вы отписались?». Оказалось дело в интерфейсе почты Mail.ru. 
 
 
 
Пользователь не хочет заходить в письмо и нажимать ссылку «Отписаться» (заголовок List-Unsubscribe присутствует в письме), он просто выделяет письмо в списке писем и жмёт кнопку «СПАМ»! И правильно, согласно правилам Mail.ru «Тема письма вида «Наша ежедневная рассылка от Фирмы» или «Ваше ежемесячное обновление `Название продукта`» помогут пользователям сразу узнать ваше письмо». То есть если пользователя перестает интересовать тема рассылки – он однозначно вас идентифицирует и отправит в СПАМ как более его не интересующее! 
 
Пятый прокол. Если пользователь не заходил долго в интерфейс почты и за это время получил более одной рассылки – то беда. Если пользователя более не интересует ваша рассылка, то согласно предыдущего «прокола» пользователь выделяет сразу несколько ваших писем (он ведь вас однозначно идентифицирует по теме или отправителю) и нажимает «СПАМ». И вы получаете в графе «Жалобы» не единичку, а цифру идентичную количеству выделенных писем – а ведь пользователь один и жалоба по сути одна. 
 
P.S. Никогда Вам не стать честным рассыльщиком. За год мне всего один раз удалось добиться нулевого рейтинга. Хотя как показывает опыт рейтинг ни на что влияет — Mail.ru может согласно принципа «корейского рандома» может отправить ваши письма в спам.
